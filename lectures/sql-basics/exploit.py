import sqlite3

conn = sqlite3.connect("data/exploitable_db.sqlite")
c = conn.cursor()


def connect(username, password):
    query = """
        SELECT *
        FROM users
        WHERE users.username = ?
        AND users.password = ?
    """
    c.execute(query, (username, password))
    user = c.fetchone()
    if user is None:
        return "Unauthorized"
    else:
        return "Authorized"


connect("john", "' OR TRUE; --")
